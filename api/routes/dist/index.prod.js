"use strict";var express=require("express"),webpack=require("webpack"),configW=require("../../webpack.config"),compiler=webpack(configW),path=require("path"),vhost=require("vhost"),cors=require("cors"),helmet=require("helmet"),compression=require("compression"),_require=require("process"),config=_require.config;module.exports=function(e){var r=e.apiRouter,i=express.Router();return i.use("/public",express.static(path.join(__dirname,"../../public"))),i.use(cors()).use(express.json()).use(helmet()).use(compression()),"production"!==process.env.NODE_ENV&&i.use(require("webpack-dev-middleware")(compiler,{noInfo:!0,publicPath:configW.output.publicPath})),i.use(vhost("api.*",r)),i.get("/*",function(e,r){r.sendFile(path.join(__dirname,"../../index.html"))}),i};