"use strict";var jwt=require("jsonwebtoken"),_require=require("../config"),JWT_SECRET=_require.JWT_SECRET;module.exports=function(n,o,i){var e=n.headers.authorization;if(!e)return o.send({ok:!1,profile:null,token:null,message:"El token tiene que ser enviado"});jwt.verify(e,JWT_SECRET,function(e,r){return e?o.send({ok:!1,profile:null,token:null,message:"Token invalido"}):(n.user=r.user,void i())})};